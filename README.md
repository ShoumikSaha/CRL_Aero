# Contrastive Representation Learning for Aerodynamics Data Prediction
This is the implementation of the paper [Contrastive Representation Learning for Regression-based Aerodynamics Problem: Fuselage and Airfoil](https://arc.aiaa.org/doi/10.2514/6.2025-0477).
Here, we leveraged Regression-based Contrastive Representation Learning method to predict drag and lift coefficients. 
At first, we applied this on Fuselage data that was generated by our work as well.
Then we extended our model's application to the airfoil (NACA) dataset to demonstrate the robustness of our method.
We hope this will motivate practitioners from Aerospace to adopt our proposed CRL method.

<div align="center">
<img src="figs/framework.jpg" width="500px">
</div>


## Dataset Preparation
Convert your dataset into a csv format, and keep a column with `split` for train, validation and test set. 
We would also recommend to normalize your data before using it for the model. 
The `dataset.py` file will handle the dataset. Depending on your input file path, you might have to change the CSV file path.

## Training the Models

### Phase 1
In this phase, **train the encoder model by running `main_smk_rnc.py`.** 

Remember to parse the right values, especially for `data_folder`, `dataset`, `epochs`, `learning_rate`, `batch_size`, etc.

After running this file, it will save the trained model in a folder named `save`. 
We used 2 different MLP models as the encoder for our use cases. You can write your own encoder instead of using ours from `my_mlp.py`.


### Phase 2
In this phase, **train the predictor model by running `main_linear.py`.** 

Remember to pass the path of the saved encoder model from Phase 1 through the `ckpt` argument.
